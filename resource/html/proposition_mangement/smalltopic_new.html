<!DOCTYPE html>
<html lang="ZH-cn" data-identity="88">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,minimum-scale=1, maximum-scale=1">
    <title>发布小命题</title>
    <link rel="stylesheet" href="../../assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../../assets/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="../../assets/css/cmui.min.css"/>
    <link rel="stylesheet" href="../../assets/css/base.min.css"/>
    <link rel="stylesheet" href="../../assets/css/innerbase.min.css"/>
    <style type="text/css">
        .form .form-group {
            margin-bottom: 20px;
        }

        .pos-r {
            position: relative
        }

        .pos-r span {
            position: absolute;
            top: 6px;
            left: 425px;
        }

        .dialog-sm .modal-dialog {
            width: 510px
        }

        label.error {
            margin-left: 116px;
        }

        .form .form-group label {
            text-align: left;
        }

        .form .form-group label.label {
            display: inline-block;
            width: 113px;
            text-align: right;
            color: #666;
            font-size: 14px;
            padding: 0;
        }

        .form .form-group input[type='text'].w300 {
            width: 300px;
        }

        .form .form-group select {
            border: 1px solid #ccc;
        }

        .module-header {
            margin-bottom: 29px;
        }

        a {
            cursor: pointer;
        }

        .sel label.error {
            margin-left: 0;
        }
    </style>
</head>
<body>
<div class="main-container">
    <ol class="breadcrumb">
        <li>命题管理</li>
        <li>小命题管理</li>
        <li>发布小命题</li>
    </ol>
    <div>
        <div class="module-header">
            <h4>发布小命题</h4>
        </div>
        <form class="form" id="resume_form">
            <div class="form-group">
                <label class="label">命题名称：</label>
                <input type="text" id="rName" maxlength="100" name="rName"
                       placeholder="请输入命题名称，可包括中英文字母数字、标点符号，不超过100字"/>
            </div>
            <div class="form-group">
                <label class="label">发榜单位：</label>
                <input type="text" id="" name="unit" placeholder="请准确输入发榜单位名称全称，可包括中英文字母数字"/>
            </div>
            <div class="form-group">
                <label class="label">项目领域：</label>
                <div class="clearfix" style="display: inline-block">
                    <div class="sel pull-left">
                        <span>一级领域</span>
                        <select>
                            <option value="" disabled selected style="display: none;">请选择</option>
                            <option>业务</option>
                            <option>网络</option>
                            <option>IT</option>
                        </select>
                    </div>
                    <div class="sel pull-left">
                        <span>二级领域</span>
                        <select>
                            <option value="" disabled selected style="display: none;">请选择</option>
                            <option>家庭业务</option>
                            <option>车联网</option>
                            <option>智能硬件</option>
                            <option>教育</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="label">联系人：</label>
                <input type="text" class="w300" id="linkMan" name="linkMan" placeholder="请填写联系人"/>
            </div>
            <div class="form-group">
                <label class="label">联系电话：</label>
                <input type="text" class="w300" id="linkPhone" name="linkPhone" placeholder="请填写联系方式"/>
            </div>
            <div class="form-group">
                <label class="label">联系邮箱：</label>
                <input type="text" class="w300" id="email" name="email" placeholder="请填写邮箱地址"/>
            </div>
            <div class="form-group">
                <label class="label">悬赏人：</label>
                <input type="text" class="w300" id="offeringMan" name="offeringMan" placeholder="请填写悬赏人"/>
            </div>
            <div class="form-group pos-r">
                <label class="label">命题奖金：</label>
                <input type="text" class="w300" id="bonus" name="bonus" placeholder="请输入金额"/><span>元</span>
            </div>
            <div class="form-group">
                <label class="label">完成时限：</label>
                <input type="text" id="times" name="times" placeholder="请准确输入完成时限要求，可包括中英文字母数字，如三个月"/>
            </div>
            <div class="form-group">
                <label class="label">打榜有效期：</label>
                <input type="text" id="validity" name="validity" placeholder="请准确输入打榜有效期，可包括中英文字母数字，如三个月"/>
            </div>
            <div class="form-group">
                <label class="label">命题阐述：</label>
                <textarea type="text" id="rDesc" name="rDesc" placeholder="请输入命题阐述，可包括中英文字母数字、标点符号，不超出500字"
                          maxlength="500"></textarea>
            </div>
            <div class="form-group">
                <label class="label">提出背景：</label>
                <textarea type="text" id="background" name="background" placeholder="请输入命题提出背景，可包括中英文字母数字、标点符号，不超出500字"
                          maxlength="500"></textarea>
            </div>
            <div class="form-group">
                <label class="label">验收指标：</label>
                <textarea type="text" id="standard" name="standard" placeholder="请输入命题验收指标，可包括中英文字母数字、标点符号，不超过500字"
                          maxlength="500"></textarea>
            </div>
            <div class="form-group">
                <label class="label"></label>
                <button type="submit" class="btn-blue w80 mr-15" id="creat">发布</button>
                <button type="button" class="btn-default w80 mr-15" id="cancel">取消</button>
                <a id="save-topic">保存为草稿</a>
            </div>
        </form>
    </div>
    <!--确认提交     start-->
    <div class="modal fade dialog-sm" id="sub-sure" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content bd-muted w510">
                <div class="modal-header bg-muted bd-muted">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h5 class="modal-title text-left">提示</h5>
                </div>
                <div class="modal-body">
                    <div class="text-center con">
                        <p>是否确定发布命题内容？</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <a class="btn-blue w80" id="topic-add-btn">确定</a>
                    <a class="btn-default w80" href="" data-dismiss="modal">取消</a>
                </div>
            </div>
        </div>
    </div>
    <!--确认提交     end-->
    <!--确认保存     start-->
    <div class="modal fade dialog-sm" id="save-sure" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content bd-muted w510">
                <div class="modal-header bg-muted bd-muted">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h5 class="modal-title text-left">提示</h5>
                </div>
                <div class="modal-body">
                    <div class="text-center con">
                        <p>是否确定保存命题内容？</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <a class="btn-blue w80" id="topic-save-btn">确定</a>
                    <a class="btn-default w80" href="" data-dismiss="modal">取消</a>
                </div>
            </div>
        </div>
    </div>
    <!--确认保存     end-->
    <!--操作返回     start-->
    <div class="modal fade dialog-sm" id="sub-success" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content bd-muted w510">
                <div class="modal-header bg-muted bd-muted">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h5 class="modal-title">提示</h5>
                </div>
                <div class="modal-body">
                    <h3 class="green mt-15 mb-20">发布成功！</h3>
                    <p></p>
                    <div class="mt-20">
                        <a class="btn-blue w80" data-dismiss="" href="" id="success_sure">确定</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--操作返回     end-->

</div>

<script src="../../assets/lib/require.js"></script>
<script src="../../assets/js/config.js"></script>

<script type="text/javascript">
    require(["common", "bootstrap", "webtools", "validate"], function (c, b, w, v) {
        window.onbeforeunload = function () {
            if (!flag) return '您尚有未提交的内容，离开将丢失此内容。'
        };
        // 发布命题     start
        // 表单校验
        $("#resume_form").validate(validateDate);
        $('#creat').on('click', function () {
            var validator = $("#resume_form").validate(validateDate);
            if (validator.form()) {
                $("#sub-sure").modal("show");
            }
        });
        $('#topic-add-btn').on('click', function () {
            $("#sub-sure").modal("hide");
            $.ajax({
                type: "POST",
                url: "",
                dataType: "text",
                async: true,
                data: $("#resume_form").serialize(),
                success: function (data, code) {
                    if (data == 1) {
//						alert("提交成功！");
                        $("#sub-success").modal("show");
                        $("#sub-success h3").text("发布成功！");
                        $("#sub-success a").attr({
                            "href": "smalltopic_list.html",
                            "data-dismiss": ""
                        });
                        $("#sub-success p").text("");
                    } else {
//						alert("提交出错！");
                        $("#sub-success").modal("show");
                        $("#sub-success h3").text("发布失败！");
                        $("#sub-success a").attr({
                            "href": "",
                            "data-dismiss": "modal"
                        });
                        $("#sub-success p").text("Error Code：code");
                    }
                },
                error: function (data, status, e) {
                    alert("提交出错！!!!");
                }
            });
        });
        // 发布命题     end
        // 保存命题     start
        $('#save-topic').on('click', function () {
            $('label.error').remove();
            var requiredName = $('#rName').val(),
                    requiredCom = $('#company').val();
            if (!requiredName && !requiredCom) {
                $('#rName').focus().after('<label for="topicName" class="error">请输入命题名称</label>');
                $('#company').focus().after('<label for="topicName" class="error">请输入发榜单位</label>');
            } else if (!requiredName) {
                $('#rName').focus().after('<label for="topicName" class="error">请输入命题名称</label>');
            } else if (!requiredCom) {
                $('#company').focus().after('<label for="topicName" class="error">请输入发榜单位</label>');
            } else {
                $("#save-sure").modal("show");
            }
        });
        $('#topic-save-btn').on('click', function () {
            $("#save-sure").modal("hide");
            $.ajax({
                type: "POST",
                url: "",
                dataType: "text",
                async: true,
                data: $("#resume_form").serialize(),
                success: function (data, code) {
                    if (data == 1) {
//						alert("提交成功！");
                        $("#sub-success").modal("show");
                        $("#sub-success h3").text("保存成功！");
                        $("#sub-success a").attr({
                            "href": "",
                            "data-dismiss": "modal"
                        });
                        $("#sub-success p").text("");
                    } else {
//						alert("提交出错！");
                        $("#sub-success").modal("show");
                        $("#sub-success h3").text("保存失败！");
                        $("#sub-success a").attr({
                            "href": "",
                            "data-dismiss": "modal"
                        });
                        $("#sub-success p").text("Error Code：code");
                    }
                },
                error: function () {
                    alert("提交出错！!!!");
                }
            });
        });
        // 保存命题     end

        $('#cancel').on('click', function () {
            window.location.href = "smalltopic_list.html";
        });
    });

</script>
</body>
</html>
