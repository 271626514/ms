<!DOCTYPE html>
<html lang="ZH-cn" data-identity="88">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,minimum-scale=1, maximum-scale=1">
    <title>修改小命题</title>
    <link rel="stylesheet" href="../../assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../../assets/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="../../assets/css/cmui.min.css"/>
    <link rel="stylesheet" href="../../assets/css/base.min.css"/>
    <link rel="stylesheet" href="../../assets/css/innerbase.min.css"/>
    <style type="text/css">
        .form .form-group {
            margin-bottom: 20px;
        }

        .pos-r {
            position: relative
        }

        .pos-r span {
            position: absolute;
            top: 6px;
            left: 425px;
        }

        .dialog-sm .modal-dialog {
            width: 510px
        }

        label.error {
            margin-left: 116px;
        }

        .form .form-group label {
            text-align: left;
        }

        .form .form-group label.label {
            display: inline-block;
            width: 113px;
            text-align: right;
            color: #666;
            font-size: 14px;
        }

        .form .form-group input[type='text'].w300 {
            width: 300px;
        }

        .form .form-group select {
            border: 1px solid #ccc;
        }

        .module-header {
            margin-bottom: 29px;
        }

        a {
            cursor: pointer
        }

        .sel label.error {
            margin-left: 0;
        }

        .form-group p {
            display: inline-block;
            margin-bottom: 0;
            line-height: 30px
        }
    </style>
</head>
<body>
<div class="main-container">
    <ol class="breadcrumb">
        <li>命题管理</li>
        <li>小命题管理</li>
        <li>修改小命题</li>
    </ol>
    <div>
        <div class="module-header">
            <h4>修改小命题</h4>
        </div>
        <form class="form" id="resume_form">
            <div class="form-group">
                <label class="label">命题ID：</label>
                <p>1234567890</p>
            </div>
            <div class="form-group">
                <label class="label">命题类型：</label>
                <p>小命题</p>
            </div>
            <div class="form-group">
                <label class="label">创建人：</label>
                <p>si jia qing／司家庆</p>
            </div>
            <div class="form-group">
                <label class="label">创建时间：</label>
                <p>2016.12.08 18:00</p>
            </div>
            <div class="form-group">
                <label class="label">发布时间：</label>
                <p>2016.12.08 18:00</p>
            </div>
            <div class="form-group">
                <label class="label">命题状态：</label>
                <p>2=正在打榜</p>
                <!--<a class="" data-toggle="modal" data-target="#assignment">变更命题状态</a>-->
            </div>
            <div class="form-group">
                <label class="label">浏览次数：</label>
                <p>200次</p>
            </div>
            <div class="form-group">
                <label class="label">打榜次数：</label>
                <p>100次</p>
            </div>
            <div class="form-group">
                <label class="label">命题名称：</label>
                <input type="text" id="rName" maxlength="100" name="rName"
                       placeholder="请输入命题名称，可包括中英文字母数字、标点符号，不超过100字"/>
            </div>
            <div class="form-group">
                <label class="label">发榜单位：</label>
                <input type="text" id="company" name="company" placeholder="请输入准确的发榜单位名称全称，可包括中英文字母数字"/>
            </div>
            <div class="form-group">
                <label class="label">项目领域：</label>
                <div class="clearfix" style="display: inline-block">
                    <div class="sel pull-left">
                        <span>一级领域</span>
                        <select>
                            <option>业务</option>
                            <option>网络</option>
                            <option>IT</option>
                        </select>
                    </div>
                    <div class="sel pull-left">
                        <span>二级领域</span>
                        <select>
                            <option>家庭业务</option>
                            <option>车联网</option>
                            <option>智能硬件</option>
                            <option>教育</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="label">联系人：</label>
                <input type="text" class="w300" id="linkMan" name="linkMan" placeholder="请输入联系人姓名"/>
            </div>
            <div class="form-group">
                <label class="label">联系电话：</label>
                <input type="text" class="w300" id="linkPhone" name="linkPhone" placeholder="请输入联系人的电话号码"/>
            </div>
            <div class="form-group">
                <label class="label">联系邮箱：</label>
                <input type="text" class="w300" id="email" name="email" placeholder="请输入联系人的邮箱地址"/>
            </div>
            <div class="form-group">
                <label class="label">悬赏人：</label>
                <input type="text" class="w300" id="offeringMan" name="offeringMan" placeholder="请输入悬赏人姓名"/>
            </div>
            <div class="form-group pos-r">
                <label class="label">命题奖金：</label>
                <input type="text" class="w300" id="bonus" name="bonus" placeholder="请输入金额"/><span>元</span>
            </div>
            <div class="form-group">
                <label class="label">完成时限：</label>
                <input type="text" id="rTime" name="rTime" placeholder="请准确输入完成时限要求，可包括中英文字母数字，如三个月"/>
            </div>
            <div class="form-group">
                <label class="label">打榜有效期：</label>
                <input type="text" id="validity" name="validity" placeholder="请准确输入打榜有效期，可包括中英文字母数字，如三个月"/>
            </div>
            <div class="form-group">
                <label class="label">命题阐述：</label>
                <textarea type="text" id="rDesc" name="rDesc" placeholder="请输入命题阐述，可包括中英文字母数字、标点符号，不超出500字"
                          maxlength="500"></textarea>
            </div>
            <div class="form-group">
                <label class="label">提出背景：</label>
                <textarea type="text" id="background" name="background" placeholder="请输入命题提出背景，可包括中英文字母数字、标点符号，不超出500字"
                          maxlength="500"></textarea>
            </div>
            <div class="form-group">
                <label class="label">验收指标：</label>
                <textarea type="text" id="topicaim" name="topicaim" placeholder="请输入命题验收指标，可包括中英文字母数字、标点符号，不超过500字"
                          maxlength="500"></textarea>
            </div>
            <div class="form-group">
                <label class="label"></label>
                <!--如果是命题，进入此页面显示以下两个按钮     start-->
                <button type="submit" class="btn-blue w80 mr-15" id="creat">确定修改</button>
                <button type="button" class="btn-default w80" id="cancel">取消</button>
                <!--如果是命题，进入此页面显示以上两个按钮     end-->
                <!--如果是草稿，进入此页面显示以下三个按钮     start-->
                <a class="btn-blue w80 mr-15" id="save-topic">保存为草稿</a>
                <button type="submit" class="btn-blue w80 mr-15" id="creat">发布命题</button>
                <button type="button" class="btn-default w80" id="cancel">取消</button>
                <!--如果是草稿，进入此页面显示以上三个按钮     end-->
            </div>
        </form>
    </div>

    <!--变更状态弹窗      start-->
    <!--<div class="modal fade dialog-sm" id="assignment" data-backdrop="static" >-->
    <!--<div class="modal-dialog w560">-->
    <!--<div class="modal-content bd-muted">-->
    <!--<div class="modal-header bg-muted bd-muted">-->
    <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>-->
    <!--<h5 class="modal-title text-left">变更状态</h5>-->
    <!--</div>-->
    <!--<div class="modal-body">-->
    <!--<p class="text-left">是否确定对以下命题进行状态变更：</p>-->
    <!--<table class="table text-center table-bordered-noheader">-->
    <!--<thead>-->
    <!--<tr>-->
    <!--<th>ID</th>-->
    <!--<th>类型</th>-->
    <!--<th>名称</th>-->
    <!--</tr>-->
    <!--</thead>-->
    <!--<tbody>-->
    <!--<tr>-->
    <!--<td class="topicID">12345678</td>-->
    <!--<td>大命题</td>-->
    <!--<td>基于wifi方式的室内定位方法及产品研发</td>-->
    <!--</tr>-->
    <!--</tbody>-->
    <!--</table>-->
    <!--<p class="text-left">-->
    <!--状态变更为：-->
    <!--<select>-->
    <!--<option>正在打榜</option>-->
    <!--<option>命题结束</option>-->
    <!--</select>-->
    <!--</p>-->
    <!--<p class="text-left">-->
    <!--批量设置权限：<span>司家庆</span>-->
    <!--</p>-->
    <!--<div class="mt-20">-->
    <!--<button class="btn-blue w80" id="statechange">确定</button>-->
    <!--<button class="btn-default w80" data-dismiss="modal">取消</button>-->
    <!--</div>-->
    <!--</div>-->

    <!--</div>&lt;!&ndash; /.modal-content &ndash;&gt;-->
    <!--</div>&lt;!&ndash; /.modal-dialog &ndash;&gt;-->
    <!--</div>-->
    <!--变更状态弹窗     end-->
    <!--确认修改     start-->
    <div class="modal fade dialog-sm" id="sub-sure" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content bd-muted w510">
                <div class="modal-header bg-muted bd-muted">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h5 class="modal-title text-left">提示</h5>
                </div>
                <div class="modal-body">
                    <div class="text-center con">
                        <p>是否确定修改命题内容？</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <a class="btn-blue w80" id="topic-add-btn">确定</a>
                    <a class="btn-default w80" data-dismiss="modal">取消</a>
                </div>
            </div>
        </div>
    </div>
    <!--确认修改     end-->
    <!--确认修改草稿     start-->
    <div class="modal fade dialog-sm" id="save-sure" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content bd-muted w510">
                <div class="modal-header bg-muted bd-muted">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h5 class="modal-title text-left">提示</h5>
                </div>
                <div class="modal-body">
                    <div class="text-center con">
                        <p>是否确定修改命题草稿内容？</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <a class="btn-blue w80" id="topic-save-btn">确定</a>
                    <a class="btn-default w80" data-dismiss="modal">取消</a>
                </div>
            </div>
        </div>
    </div>
    <!--确认修改草稿     end-->

    <!--操作返回     start-->
    <div class="modal fade dialog-sm" id="sub-success" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content bd-muted w510">
                <div class="modal-header bg-muted bd-muted">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h5 class="modal-title">提示</h5>
                </div>
                <div class="modal-body">
                    <h3 class="green mt-15 mb-20">修改成功！</h3>
                    <p></p>
                    <div>
                        <a class="btn-blue w80" data-dismiss="" href="" id="success_sure">确定</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--操作返回     end-->

</div>

<script src="../../assets/lib/require.js"></script>
<script src="../../assets/js/config.js"></script>

<script type="text/javascript">
    require(["common", "bootstrap", "webtools", "validate"], function (c, b, w, v) {
        window.onbeforeunload = function () {
            if (!flag) return '您尚有未提交的内容，离开将丢失此内容。'
        };
        //	变更状态     start
//		$("#statechange").on("click",function(){
//			var selID = $('.topicID').text();
//			var selval = $('#assignment').find("select").val();
//			$("#assignment").modal("hide");
//			$.ajax({
//				url:'json.json',
//				type: 'post',
//				data: {"id":selID,"val":selval},
//				dataType: '',
//				success: function (data,code) {
//					if(data.msg=="success"){
//						$("#sub-success").modal("show");
//						$("#sub-success h3").text("变更成功！");
//						$("#sub-success a").attr({
//							"href":"",
//							"data-dismiss":"modal"
//						});
//						$("#sub-success p").text("");
//					}else{
//						$("#sub-success").modal("show");
//						$("#sub-success h3").text("变更失败！");
//						$("#sub-success a").attr({
//							"href":"",
//							"data-dismiss":"modal"
//						});
//						$("#sub-success p").text("Error Code：code");
//					}
//				},
//				error:function(){
//					alert('操作失败：Error CodeXXXX');
//					window.location.href = "";
//				}
//			})
//		});
        //	变更状态     end
        // 表单校验
        $("#resume_form").validate(validateDate);
        $('#creat').on('click', function () {
            var validator = $("#resume_form").validate(validateDate);
            if (validator.form()) {
                $("#sub-sure").modal("show");
            }
        });
        $('#topic-add-btn').on('click', function () {
            $("#sub-sure").modal("hide");
            $.ajax({
                type: "POST",
                url: "",
                dataType: "text",
                async: true,
                data: $("#resume_form").serialize(),
                success: function (data, code) {
                    if (data == 1) {
//						alert("提交成功！");
                        $("#sub-success").modal("show");
                        $("#sub-success h3").text("修改成功！");
                        $("#sub-success a").attr({
                            "href": "smalltopic_list.html",
                            "data-dismiss": ""
                        });
                        $("#sub-success p").text("Error Code：code");
                    } else {
//						alert("提交出错！");
                        $("#sub-success").modal("show");
                        $("#sub-success h3").text("修改失败！");
                        $("#sub-success a").attr({
                            "href": "",
                            "data-dismiss": "modal"
                        });
                    }
                },
                error: function (data, status, e) {
                    alert("提交出错！!!!");
                }
            });
        });

        // 继续保存为草稿    start
        $('#save-topic').on('click', function () {
            $('label.error').remove();
            var requiredName = $('#rName').val(),
                    requiredCom = $('#company').val();
            if (!requiredName && !requiredCom) {
                $('#rName').focus().after('<label for="rName" class="error">请输入命题名称</label>');
                $('#company').after('<label for="company" class="error">请输入发榜单位</label>');
            } else if (!requiredName) {
                $('#rName').focus().after('<label for="rName" class="error">请输入命题名称</label>');
            } else if (!requiredCom) {
                $('#company').focus().after('<label for="company" class="error">请输入发榜单位</label>');
            } else {
                $("#save-sure").modal("show");
            }
        });
        $('topic-save-btn').on('click', function () {
            $("#save-sure").modal("hide");
            $.ajax({
                type: "POST",
                url: "${ctx }/smallRequirement/smallRequirementEdit?requirementId=" + id,
                dataType: "text",
                data: $("#resume_form").serialize(),
                success: function (data, code) {
                    if (data == "ok") {
                        $("#sub-success").modal("show");
                        $("#sub-success h3").text("保存成功！");
                        $("#sub-success a").attr({
                            "href": "${ctx}/smallRequirement/list",
                            "data-dismiss": ""
                        });
                        $("#sub-success p").text("");
                    } else {
                        $("#sub-success").modal("show");
                        $("#sub-success h3").text("保存失败！");
                        $("#sub-success a").attr({
                            "href": "",
                            "data-dismiss": "modal"
                        });
                        $("#sub-success p").text("Error Code：code");
                    }
                },
                error: function (data, status, e) {
                    alert("发布出错！!!!");
                }
            });
        });
        // 继续保存为草稿     end

        $('#cancel').on('click', function () {
            window.location.href = "smalltopic_list.html";
        });
    });

</script>
</body>
</html>
